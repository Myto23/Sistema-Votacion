<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Votación</title>
  <link rel="stylesheet" href="votacion.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="votacion.js"></script>
  <script>
    $(document).ready(function() {
      $('#rut').on('input', function() {
        $(this).val($(this).val().replace(/[^0-9]/g, ''));
      });
    });
    function submitVote() {
      var fullName = $('#full_name').val();
      var alias = $('#alias').val();
      var rut = $('#rut').val();
      var email = $('#email').val();
      var region = $('#region').val();
      var candidate = $('#candidate').val();
      var comuna = $('#comuna').val();
      var heardAboutUs = $('input[name="heardAboutUs"]:checked').map(function() {
        return $(this).val();
      }).get().join(', ');

      if (fullName === "" || rut === "" || email === "" || region === "" || !candidate || !comuna) {
        alert("Por favor, rellene todos los campos requeridos.");
        return;
      }

      $.ajax({
        type: 'POST',
        url: 'votacion.php',
        data: {
          full_name: fullName,
          alias: alias,
          rut: rut,
          email: email,
          region: region,
          candidate: candidate,
          comuna: comuna,
          heard_about_us: heardAboutUs
        },
        success: function(response) {
          alert(response);
        },
        error: function() {
          alert("Hubo un error al procesar la votación. Intente nuevamente.");
        }
      });
    }
  </script>
</head>
<body>
  <h1>Formulario Votación</h1>
  <form onsubmit="submitVote(); return false;">
    <!-- DIV DE CUADROS DE TEXTOS -->
    <div class="textos-container">
      <div class="input-wrapper">
        <label for="full_name">Nombre y Apellido:</label>
        <input type="text" id="full_name" name="full_name" required>
      </div>
    
      <div class="input-wrapper">
        <label for="alias">Alias:</label>
        <input type="text" id="alias" name="alias">
      </div>
    
      <div class="input-wrapper">
        <label for="rut">RUT:</label>
        <input type="text" id="rut" name="rut" maxlength="9" placeholder="Si termina en K reemplace por 0" title="El RUT debe contener solo números, la letra 'k' opcional al final, y tener entre 8 y 9 dígitos." required>
      </div>
    
      <div class="input-wrapper">
        <label for="email">Correo Electrónico:</label>
        <input type="email" id="email" name="email" required>
      </div>
    </div>
  
    <!-- DIV DE CUADROS DE COMBOBOX -->
    <div class="combosx-container">
      <div class="input-wrapper">
        <label for="region">Región:</label>
        <select id="region" name="region" required>
          <option value="">Seleccione una región</option>
        </select>
      </div>
    
      <div class="input-wrapper">
        <label for="comuna">Comuna:</label>
        <select id="comuna" name="comuna" required>
          <option value="">Seleccione una comuna</option>
        </select>
      </div>
    
      <div class="input-wrapper">
        <label for="candidate">Candidato:</label>
        <select id="candidate" name="candidate" required>
          <option value="">Seleccione un candidato</option>
          <option value="Candidato 1">Candidato 1</option>
          <option value="Candidato 2">Candidato 2</option>
          <option value="Candidato 3">Candidato 3</option>
        </select>
      </div>
    </div>


    <!-- DIV DE CHECKBOX -->
    <div class="checkbox-container">
      <div class="checkbox-box">
        <label for="comoSeEnteroDeNosotros">Cómo se enteró de nosotros?</label>
    
        <input type="checkbox" id="web" name="heardAboutUs" value="Web">
        <label for="web">Internet</label>
    
        <input type="checkbox" id="tv" name="heardAboutUs" value="Tv">
        <label for="tv">TV</label>
    
        <input type="checkbox" id="rrss" name="heardAboutUs" value="RRSS">
        <label for="rrss">Redes Sociales</label>
    
        <input type="checkbox" id="amigos" name="heardAboutUs" value="Amigos">
        <label for="amigos">Amigos</label>
      </div>
    </div>
    <br>    
    <!-- DIV DE button -->
    <div class="button">
      <button type="submit">Votar</button>
    </div>
    
  </form>
</body>
</html>
